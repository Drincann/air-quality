# 插值预处理食用指南

## 程序干了什么

- 将$O_3$的 10X10 数据处理成了 1X1 数据
- 将$PM_{2.5}$的 5 种组分的 10X10 数据分开处理成了 5 份 1X1 数据

## 如何使用程序

1. 把要处理的数据放入对应的 input 文件夹
2. 运行 main.py（需添加起止参数）
3. 漫长的等待
4. 将处理好的数据从对应的 output 文件夹取出

## 程序处理好的数据格式

处理好的数据为 csv 文件，其组成如下：

1. 第一列：经度
2. 第二列：纬度
3. 第三列：数据（保留2位小数）

## 程序怎么做的

总的来说，每个点的值由其附近四个点的值得出。

前提：原数据忽略了不同纬度下单位经度所对应的 km 不同，处理后的数据同样如此。

要将 10X10 插值为 1X1 ，则不妨认为要在每两个数据点间插入 9 个数据。

同理，不妨认为要在围城正方形的四个数据点间 $11 \cdot 11 - 4 = 117$ 个位置插入数据，设这个矩阵为$map_{i, j}, 0 \leq i \leq 10, 0 \leq j \leq 10$，这四个数据点为$n_k, 0 \leq k \leq 3$。

于是乎，我们以这四个数据点的值作为参考数据，依据距离关系确定权值，计算这 117 个位置的数据的值。

因为对于每四个数据点围成的正方形，这 117 个数据点与四个数据点的距离关系是固定的，所以预处理出了一张权值表$w_{i, j, k}, 0 \leq i \leq 10, 0 \leq j \leq 10, 0 \leq k \leq 3$，用来记录每个点与四个参考数据点的四个权值$w_{i, j, 0}$、$w_{i, j, 1}$、$w_{i, j, 2}$、$w_{i, j, 3}$。至于权值表如何计算的，看程序就好了，很简单。

于是乎得到计算公式：
$$
map_{i, j} = \sum_{k = 0}^3 w_{i, j, k} \cdot n_k, 0 \leq i \leq 10, 0 \leq j \leq 10
$$
还有一个问题。每 2 个相邻的正方形之间有重复部分。为此在计算时不再计算$i = 10$的那一行和$j = 10$的那一列，得到：
$$
map_{i, j} = \sum_{k = 0}^3 w_{i, j, k} \cdot n_k, 0 \leq i \leq 9, 0 \leq j \leq 9
$$
就完成了。不过这也导致了右方和下方有 0.01 经纬度的误差。

## 程序可能的问题

1. 程序很慢
2. 地图边缘模糊了。
3. 右方和下方有 0.01 经纬度的误差
4. 程序暂时不具有拓展性，即只能处理现状下的数据的现状问题
5. 在数据十分稀疏的情况下，程序的插值就会很失败